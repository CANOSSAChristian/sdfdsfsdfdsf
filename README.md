
# Issc_Project

Si tratta di un’attività fuori dalla Storicizzazione UBI che ci ha commissionato Aleandro. Gli utenti dovranno eseguirla indicativamente con cadenza settimanale per circa 6 mesi. E’ perciò sufficiente una cosa abbastanza spartana, tanto poi la buttiamo.
Io pensavo ad una paginetta sulla intranet che legge il TXT e scrive un CSV o XLS. L’accesso alla pagina avverrebbe tramite link diretto che passeremo ai colleghi.
Fatemi una stima su giorni e tempi di realizzazione. Non si tratta di attività urgente.

Si deve creare una sorta di tool/macro che prenda in input un flusso come quello in allegato “S4H_FLUSSO_SEZ_....” e venga decodificato tramite il file excel “ZFI_T_OPECONT…”
Dando come risultato per ogni riga nel flusso “S4H_FLUSSO_SEZ_....”, n ritorni quanti si trovano sul file di decodifica “ZFI_T_OPECONT…”


## Input Stream

#### Flusso di ingresso .txt
#### Riga del flusso di ingresso:  1;2;3;4;5;6;7;8;9;10;11;12;13;14;15;16;17;18;19;20;21;22;23;24;25;26;27;28;29;30;31;32;33;34;35;36;37;38;39;40;41;42;43;44;45;46;47;48;49;50;51;52;53;54;55;56;57;58;59;60;61;62;63;64;65;66;67;68;69;70;71;72;73;74;75;76;77;78;79;80;;
| Posizione | Contenuto                         | Description    | Valori                               
| :--------| :------- | :------------------------- | :-------------|
|	`1`	|	`Prodotto`	|	`Prodotto di riferimento`	|	`ACCM, MCM, VCM, VCMSMART, XME`	|
|	`2`	|	`Tipo operazione`	|	`Operazione associata al flusso`	|	`Dettaglio a fine tabella`	|
|	`3`	|	`Contratto`	|	`Nr. Contratto`	|	`nnnn`	|
|	`4`	|	`Voucher`	|	`Nr. Voucher`	|	`nnnn`	|
|	`5`	|	`Seriale dispositivo`	|	`Nr. Seriale dispositivo`	|	`nnnn`	|
|	`6`	|	`IMEI Dispositivo`	|	`Nr. IMEI Dispositivo`	|	`nnnn`	|
|	`7`	|	`cf_contr`	|	`CF Contraente`	|	`ABCDEF89L55H657F`	|
|	`8`	|	`Stato dispositivo`	|	`Stato del dispositivo in magazzino`	|	`In magazzino, in consegna, Consegnato, Installato, In rientro, Reso`	|
|	`9`	|	`Componenti Aggiuntivi`	|	`Richiesta Componenti Aggiuntivi`	|	"`""Si""; ""NO""`"	|
|	`10`	|	`Esito esame box `	|	`Stato dispositivo post analisi reso`	|	"`Ricondizionato; Rigenerato; Danneggiato`"	|
|	`11`	|	`Stato contratto`	|	`Stato del contratto`	|	"`attivo; annullato`"	|
|	`12`	|	`Codice Ente`	|	`Canale di vendita`	|	`nnnn`	|
|	`13`	|	`Profilo`	|	`Profilo del contraente`	|	"`cliente; dipendente`"	|
|	`14`	|	`Contraente`	|	`Cognome e Nome del contraente`	|	`Rossi Mario`	|
|	`15`	|	`Emissione contratto`	|	`Data di sottoscrizione`	|	`gg-mm-aaaa`	|
|	`16`	|	`Decorrenza contratto`	|	`Data di inizio contratto`	|	`gg-mm-aaaa`	|
|	`17`	|	`Scadenza contratto`	|	`Data di fine contratto`	|	`gg-mm-aaaa`	|
|	`18`	|	`Frazionamento`	|	`Periodicità di pagamento`	|	"`Annuale; Mensile`"	|
|	`19`	|	`Data estinzione`	|	`Eventuale data di annullamento contratto`	|	`gg-mm-aaaa`	|
|	`20`	|	`Motivo estinzione`	|	`Motivo di annullamento contratto`	|	"`Disdetta assicurato; Recesso; Annullo; Storno`"	|
|	`21`	|	`Motivo annullo`	|	`Causa di annullo del contratto`	|	`Cessione immobile, estinzione c/c, upgrade polizza`	|
|	`22`	|	`Apertura Voucher`	|	`Data di emissione del voucher`	|	`gg-mm-aaaa`	|
|	`23`	|	`Scadenza Voucher`	|	`Data di chiusura del voucher`	|	`gg-mm-aaaa`	|
|	`24`	|	`Convenzione`	|	`Eventuale presenza di convenzioni`	|	"`MUTUI_01; Blank`"	|
|	`25`	|	`Annualità`	|	`In quale annualità si trova il contratto`	|	"`1;2`"	|
|	`26`	|	`data_contabile`	|	`Data contabile dell'operazione`	|	`gg-mm-aaaa`	|
|	`TBD`	|	`Data_valuta`	|	`Data valuta dell’Incasso effettivamente avvenuto sul C/C`	|	`gg-mm-aaaa`	|
|	`27`	|	`costonetto_comp agg`	|	`Costo al Netto IVA per componenti aggiuntivi`	|	`€€€`	|
|	`28`	|	`IVA comp agg`	|	`IVA sul costo componenti aggiuntivi (22%)`	|	`€€€`	|
|	`29`	|	`costo_comp agg`	|	`Costo al lordo IVA per Componenti aggiuntivi`	|	`€€€`	|
|	`30`	|	`costoatt_netto`	|	`Importo voucher/somma up-front al netto IVA`	|	`€€€`	|
|	`31`	|	`IVA att`	|	`IVA sull'Importo voucher/somma up-front  (22%)`	|	`€€€`	|
|	`32`	|	`costoatt_lordo`	|	`Importo voucher/somma up-front  al lordo IVA`	|	`€€€`	|
|	`33`	|	`canone annuo_netto`	|	`Canone annuo al netto IVA`	|	`€€€`	|
|	`34`	|	`IVA canone`	|	`IVA su canone annuo (22%)`	|	`€€€`	|
|	`35`	|	`canone annuo_lordo`	|	`Canone annuo al lordo IVA`	|	`€€€`	|
|	`36`	|	`emissione cartaceo_netto`	|	`Costo di emissione fattura cartacea al netto IVA`	|	`€€€`	|
|	`37`	|	`IVA emissione cartaceo (22%)`	|	`IVA su costo emissione ft.cartacea (22%)`	|	`€€€`	|
|	`38`	|	`emissione cartaceo_lordo`	|	`Costo di emissione fattura cartacea al lordo IVA`	|	`€€€`	|
|	`39`	|	`costo att_incassato_netto`	|	`Voucher/somma up-front incassato al netto IVA`	|	`€€€`	|
|	`40`	|	`IVA att_incassato_netto`	|	`IVA Voucher/somma up-front incassato`	|	`€€€`	|
|	`41`	|	`costo att_incassato_lordo`	|	`Voucher/somma up-front incassato al lordo IVA`	|	`€€€`	|
|	`42`	|	`costo att_da rimborsare`	|	`Costo da rimborsare`	|	`€€€`	|
|	`43`	|	`costo att_rimborsato`	|	`Costo rimborsato`	|	`€€€`	|
|	`44`	|	`canone_incassato_netto`	|	`Somma incassata al netto IVA`	|	`€€€`	|
|	`45`	|	`IVA canone_incassato_netto`	|	`Somma incassata al netto IVA`	|	`€€€`	|
|	`46`	|	`canone_incassato_lordo`	|	`Somma incassata al lordo IVA`	|	`€€€`	|
|	`47`	|	`sconto_netto`	|	`sconto applicato al cliente (solo fatturazione)`	|	`€€€`	|
|	`48`	|	`sconto_IVA`	|	` N.A.`	|	` N.A.`	|
|	`49`	|	`sconto_lordo`	|	` N.A.`	|	` N.A.`	|
|	`50`	|	`canone_da rimborsare`	|	`importo canone da rimborsare`	|	`€€€`	|
|	`51`	|	`canone_rimborsato`	|	`importo canone rimborsato`	|	`€€€`	|
|	`52`	|	`emissionecartaceo_incassato_netto`	|	`Somma incassata al netto IVA`	|	`€€€`	|
|	`53`	|	`IVA emissionecartaceo_incassato_netto`	|	`Somma incassata al netto IVA`	|	`€€€`	|
|	`54`	|	`emissionecartaceo_incassato_lordo`	|	`Somma incassata al lordo IVA`	|	`€€€`	|
|	`55`	|	`importo penale netto`	|	`Importo netto penale da incassare/incassata`	|	`€€€`	|
|	`56`	|	`importo penale IVA`	|	`IVA su penale da incassare/incassata`	|	`€€€`	|
|	`57`	|	`importo penale lordo`	|	`Importo lordo penale da incassare/incassata`	|	`€€€`	|
|	`58`	|	`Tipologia penale`	|	`Tipo di penale da erogare`	|	"`Mancato Reso; Mancata disinstallazione; Dispositivo danneggiato`"	|
|	`59`	|	`Penale_incassato`	|	`Esito incasso`	|	"`""OK"",""KO""`"	|
|	`60`	|	`Rate residue`	|	`Importo rate non ancora pagate, di competenza del contratto`	|	`€€€`	|
|	`61`	|	`Risconto`	|	` `	|	` `	|
|	`62`	|	`inizio risconto`	|	`data in`	|	` `	|
|	`63`	|	`fine risconto`	|	`data`	|	` `	|
|	`64`	|	`id_movimento_incassato`	|	` `	|	` `	|
|	`65`	|	`numero fattura`	|	`nr fattura`	|	`nnnn`	|
|	`66`	|	`ID_ANAG_CONTRAENTE`	|	`identificativo anagrafico contraente`	|	`nnnn`	|
|	`67`	|	`ID prenotazione`	|	`numero voucher`	|	`stringa`	|
|	`68`	|	`Data operazione`	|	`es. data prenotazione visite`	|	`gg-mm-aaaa`	|
|	`69`	|	`IVA mark-up`	|	`IVA su markup (22%)`	|	`Euro`	|
|	`70`	|	`Mark up_netto`	|	`importo mark up netto`	|	`Euro`	|
|	`71`	|	`Mark up_Lordo`	|	`importo mark up lordo`	|	`Euro`	|
|	`72`	|	`stato mark-up`	|	`stato mark-up`	|	"`""emesso"", ""da fatturare"", ""fatturato""`"	|
|	`73`	|	`importo visite  addebitato`	|	`importo  visite prenotate utente`	|	`Euro`	|
|	`74`	|	`importo provvista`	|	`importo  totale visite sostenute`	|	`Euro`	|
|	`75`	|	`importo retrocessioni netto`	|	`importo proviggione netto ricevuto da ISP o da riconoscere a PMED`	|	`Euro`	|
|	`76`	|	`IVA su retrocessioni`	|	`IVA su retrocessioni ricevuto da ISP o da riconoscere a PMED`	|	`Euro`	|
|	`77`	|	`importo retrocessioni_lordo`	|	`importo retrocessione lordo ricevuto da ISP o da riconoscere a PMED`	|	`Euro`	|
|	`78`	|	`p iva farmacista`	|	` `	|	`nnnn`	|
|	`TBD`	|	`P iva Pharmaidea`	|	` `	|	`nnnn`	|
|	`79`	|	`id_sezionale`	|	` `	|	` `	|
|	`80`	|	`Piva Partner`	|	`Partita IVA Partner`	|	`nnnn`	|

#### Flusso di ingresso Excel

| Posizione	| Prodotto	| TipoOperazione | 	D/A	| Cont.gen. | 	Testo testata documento |	Attribuzione | 	Flag account rec |	Posizione Campo |
| :-------- | :------- | :------------ | :-------- | :------- | :------------ | :-------- | :------- | :------------ |
|1|ACCM|ALTRICANONICASAMOTO|DARE|3740101103|CANONE_INCASSATO_LORDO| | |POS46|
|1|ACCM|ALTRICANONICASAMOTO|DARE|3740101103|COSTO ATT_INCASSATO_LORDO| | |POS41|
|1|ACCM|ALTRICANONICASAMOTO|DARE|3740101103|EMISSIONE_CARTACEO_INCASS| | |POS54|
|2|ACCM|ALTRICANONICASAMOTO|AVERE|3210101000|CANONE_INCASSATO_LORDO|ID_MOVIMENTO|X|POS46|
|2|ACCM|ALTRICANONICASAMOTO|AVERE|3210101000|COSTO ATT_INCASSATO_LORDO|ID_MOVIMENTO|X|POS41|
|2|ACCM|ALTRICANONICASAMOTO|AVERE|3210101000|EMISSIONE_CARTACEO_INCASS|ID_MOVIMENTO|X|POS54|
|1|ACCM|ANNULLOCASAMOTO|DARE|7130102050|RATE RESIDUE| | |POS60|
|2|ACCM|ANNULLOCASAMOTO|AVERE|3210102001|RATE RESIDUE|CONTRATTO_ANNUALIT| |POS60|
|1|ACCM|COMPAGGCASA|DARE|3210102001|COSTONETTO_COMP AGG|CONTRATTO_ANNUALIT| |POS27|
|2|ACCM|COMPAGGCASA|AVERE|7130102050|COSTONETTO_COMP AGG| | |POS27|
|1|ACCM|DISDDISPCASAMOTO|DARE|7130102050|CANONE ANNUO_NETTO| | |POS33|
|1|ACCM|DISDDISPCASAMOTO|DARE|7130102050|COSTOATT_NETTO| | |POS30|
|1|ACCM|DISDDISPCASAMOTO|DARE|7130102050|COSTONETTO_COMP AGG| | |POS27|
|1|ACCM|DISDDISPCASAMOTO|DARE|7130102050|EMISSIONE_CARTACEO_NETTO| | |POS36|
|2|ACCM|DISDDISPCASAMOTO|AVERE|3210102001|CANONE ANNUO_NETTO|CONTRATTO_ANNUALIT| |POS33|
|2|ACCM|DISDDISPCASAMOTO|AVERE|3210102001|COSTOATT_NETTO|CONTRATTO_ANNUALIT| |POS30|
|2|ACCM|DISDDISPCASAMOTO|AVERE|3210102001|COSTONETTO_COMP AGG|CONTRATTO_ANNUALIT| |POS27|
|2|ACCM|DISDDISPCASAMOTO|AVERE|3210102001|EMISSIONE_CARTACEO_NETTO|CONTRATTO_ANNUALIT| |POS36|
|1|ACCM|PROVVCASAMOTO|DARE|6670906001|CANONE_INCASSATO_LORDO| | |POS46|
|1|ACCM|PROVVCASAMOTO|DARE|6670906001|COSTO ATT_INCASSATO_LORDO| | |POS41|
|2|ACCM|PROVVCASAMOTO|AVERE|5150402001|CANONE_INCASSATO_LORDO|MMAAAA| |POS46|
|2|ACCM|PROVVCASAMOTO|AVERE|5150402001|COSTO ATT_INCASSATO_LORDO|MMAAAA| |POS41|
|1|ACCM|RIMBRATECASAMOTO|DARE|3210101000|CANONE RIMBORSATO|ID_MOVIMENTO|X|POS51|
|1|ACCM|RIMBRATECASAMOTO|DARE|3210101000|COSTO ATTIVAZIONE RIMBORS|ID_MOVIMENTO|X|POS43|
|2|ACCM|RIMBRATECASAMOTO|AVERE|3740101103|CANONE RIMBORSATO| | |POS51|
|2|ACCM|RIMBRATECASAMOTO|AVERE|3740101103|COSTO ATTIVAZIONE RIMBORS| | |POS43|
|1|ACCM|RINNOVOCASAMOTO|DARE|3210102001|CANONE ANNUO_NETTO|CONTRATTO_ANNUALIT| |POS33|
|1|ACCM|RINNOVOCASAMOTO|DARE|3210102001|COSTONETTO_COMP AGG|CONTRATTO_ANNUALIT| |POS27|
|1|ACCM|RINNOVOCASAMOTO|DARE|3210102001|EMISSIONE_CARTACEO_NETTO|CONTRATTO_ANNUALIT| |POS36|
|2|ACCM|RINNOVOCASAMOTO|AVERE|7130102050|CANONE ANNUO_NETTO| | |POS33|
|2|ACCM|RINNOVOCASAMOTO|AVERE|7130102050|COSTONETTO_COMP AGG| | |POS27|
|2|ACCM|RINNOVOCASAMOTO|AVERE|7130102050|EMISSIONE_CARTACEO_NETTO| | |POS36|
|1|ACCM|RISCONTO|DARE|7130102050|RISCONTO| | |POS61|
|2|ACCM|RISCONTO|AVERE|5920102001|RISCONTO| | |POS61|
|1|MCM|ALTRICANONICASAMOTO|DARE|3740101103|CANONE_INCASSATO_LORDO| | |POS46|
|1|MCM|ALTRICANONICASAMOTO|DARE|3740101103|COSTO ATT_INCASSATO_LORDO| | |POS41|
|1|MCM|ALTRICANONICASAMOTO|DARE|3740101103|EMISSIONE_CARTACEO_INCASS| | |POS54|
|2|MCM|ALTRICANONICASAMOTO|AVERE|3210101000|CANONE_INCASSATO_LORDO|ID_MOVIMENTO|X|POS46|
|2|MCM|ALTRICANONICASAMOTO|AVERE|3210101000|COSTO ATT_INCASSATO_LORDO|ID_MOVIMENTO|X|POS41|
|2|MCM|ALTRICANONICASAMOTO|AVERE|3210101000|EMISSIONE_CARTACEO_INCASS|ID_MOVIMENTO|X|POS54|
|1|MCM|ANNULLOCASAMOTO|DARE|7130102051|RATE RESIDUE| | |POS60|
|2|MCM|ANNULLOCASAMOTO|AVERE|3210102001|RATE RESIDUE|CONTRATTO_ANNUALIT| |POS60|
|1|MCM|DISDDISPCASAMOTO|DARE|7130102051|CANONE ANNUO_NETTO| | |POS33|
|1|MCM|DISDDISPCASAMOTO|DARE|7130102051|COSTOATT_NETTO| | |POS30|
|1|MCM|DISDDISPCASAMOTO|DARE|7130102051|COSTONETTO_COMP AGG| | |POS27|
|1|MCM|DISDDISPCASAMOTO|DARE|7130102051|EMISSIONE_CARTACEO_NETTO| | |POS36|
|2|MCM|DISDDISPCASAMOTO|AVERE|3210102001|CANONE ANNUO_NETTO|CONTRATTO_ANNUALIT| |POS33|
|2|MCM|DISDDISPCASAMOTO|AVERE|3210102001|COSTOATT_NETTO|CONTRATTO_ANNUALIT| |POS30|
|2|MCM|DISDDISPCASAMOTO|AVERE|3210102001|COSTONETTO_COMP AGG|CONTRATTO_ANNUALIT| |POS27|
|2|MCM|DISDDISPCASAMOTO|AVERE|3210102001|EMISSIONE_CARTACEO_NETTO|CONTRATTO_ANNUALIT| |POS36|
|1|MCM|PROVVCASAMOTO|DARE|6670906001|CANONE_INCASSATO_LORDO| | |POS46|
|1|MCM|PROVVCASAMOTO|DARE|6670906001|COSTO ATT_INCASSATO_LORDO| | |POS41|
|2|MCM|PROVVCASAMOTO|AVERE|5150402001|CANONE_INCASSATO_LORDO|MMAAAA| |POS46|
|2|MCM|PROVVCASAMOTO|AVERE|5150402001|COSTO ATT_INCASSATO_LORDO|MMAAAA| |POS41|
|1|MCM|RIMBRATECASAMOTO|DARE|3210101000|CANONE RIMBORSATO|ID_MOVIMENTO|X|POS51|
|1|MCM|RIMBRATECASAMOTO|DARE|3210101000|COSTO ATTIVAZIONE RIMBORS|ID_MOVIMENTO|X|POS43|
|2|MCM|RIMBRATECASAMOTO|AVERE|3740101103|CANONE RIMBORSATO| | |POS51|
|2|MCM|RIMBRATECASAMOTO|AVERE|3740101103|COSTO ATTIVAZIONE RIMBORS| | |POS43|
|1|MCM|RINNOVOCASAMOTO|DARE|3210102001|CANONE ANNUO_NETTO|CONTRATTO_ANNUALIT| |POS33|
|1|MCM|RINNOVOCASAMOTO|DARE|3210102001|EMISSIONE_CARTACEO_NETTO|CONTRATTO_ANNUALIT| |POS36|
|2|MCM|RINNOVOCASAMOTO|AVERE|7130102051|CANONE ANNUO_NETTO| | |POS33|
|2|MCM|RINNOVOCASAMOTO|AVERE|7130102051|EMISSIONE_CARTACEO_NETTO| | |POS36|
|1|MCM|RISCONTO|DARE|7130102051|RISCONTO| | |POS61|
|2|MCM|RISCONTO|AVERE|5920102001|RISCONTO| | |POS61|
|1|VCM|NUOVOVCM|DARE|3210302501|CANONE_ANNUO_NETTO|MMAAAA| |POS33|
|2|VCM|NUOVOVCM|AVERE|7210713002|CANONE_ANNUO_NETTO| | |POS33|
|1|VCM|RINNOVIVCM|DARE|3210302501|CANONE_ANNUO_NETTO|MMAAAA| |POS33|
|2|VCM|RINNOVIVCM|AVERE|7210713002|CANONE_ANNUO_NETTO| | |POS33|
|1|VCM|RISCONTO|DARE|7210713002|RISCONTO| | |POS61|
|2|VCM|RISCONTO|AVERE|5920103001|RISCONTO| | |POS61|
|1|VCMSMA|NUOVOVCM|DARE|3210302501|CANONE_ANNUO_NETTO|MMAAAA| |POS33|
|2|VCMSMA|NUOVOVCM|AVERE|7210713002|CANONE_ANNUO_NETTO| | |POS33|
|1|VCMSMA|RINNOVIVCM|DARE|3210302501|CANONE_ANNUO_NETTO|MMAAAA| |POS33|
|2|VCMSMA|RINNOVIVCM|AVERE|7210713002|CANONE_ANNUO_NETTO| | |POS33|
|1|VCMSMA|RISCONTO|DARE|7210713002|RISCONTO| | |POS61|
|2|VCMSMA|RISCONTO|AVERE|5920103001|RISCONTO| | |POS61|
|1|XBAN|ADDEBRIMBVISITA|DARE|8110302001|CANONE_DA RIMBORSARE|ID_PRENOTAZIONE| |POS50|
|2|XBAN|ADDEBRIMBVISITA|AVERE|8110301001|CANONE_DA RIMBORSARE|ID_PRENOTAZIONE| |POS50|
|1|XBAN|AUTOMARKUP|DARE|3210102001|MARK UP_NETTO|CF_CONTR| |POS70|
|2|XBAN|AUTOMARKUP|AVERE|3210102102|MARK UP_NETTO|ID_PRENOTAZIONE| |POS70|
|1|XBAN|INCASSOVISITAKO|DARE|8110302001|IMPORTO VISITE  ADDEBITAT|ID_PRENOTAZIONE| |POS73|
|2|XBAN|INCASSOVISITAKO|AVERE|8110302003|IMPORTO VISITE  ADDEBITAT|ID_PRENOTAZIONE| |POS73|
|1|XBAN|INCASSOVISITAOK|DARE|8110302002|IMPORTO VISITE  ADDEBITAT| | |POS73|
|2|XBAN|INCASSOVISITAOK|AVERE|8110302003|IMPORTO VISITE  ADDEBITAT|ID_PRENOTAZIONE| |POS73|
|1|XBAN|MARKUPTOTMESE|DARE|3210102102|MARK UP_NETTO|ID_PRENOTAZIONE| |POS70|
|2|XBAN|MARKUPTOTMESE|AVERE|3210102001|MARK UP_NETTO|CF_CONTR| |POS70|
|1|XBAN|NUOVAVISITA|DARE|8110302003|IMPORTO VISITE  ADDEBITAT|ID_PRENOTAZIONE| |POS73|
|2|XBAN|NUOVAVISITA|AVERE|8110302001|IMPORTO VISITE  ADDEBITAT|ID_PRENOTAZIONE| |POS73|
|1|XBAN|PAGPROVVISTA|DARE|8110302004|IMPORTO PROVVISTA|ID_PRENOTAZIONE| |POS74|
|2|XBAN|PAGPROVVISTA|AVERE|8110302002|IMPORTO PROVVISTA| | |POS74|
|1|XBAN|PAGRIMBVISITA|DARE|8110301001|CANONE_RIMBORSATO|ID_PRENOTAZIONE| |POS51|
|2|XBAN|PAGRIMBVISITA|AVERE|8110302002|CANONE_RIMBORSATO| | |POS51|
|1|XBAN|PROVVMINVIS|DARE|8110302001|IMPORTO PROVVISTA|ID_PRENOTAZIONE| |POS74|
|2|XBAN|PROVVMINVIS|AVERE|8110302004|IMPORTO PROVVISTA|ID_PRENOTAZIONE| |POS74|
|5|XBAN|PROVVMINVIS|DARE|3210102001|MARK UP_NETTO|CF_CONTR| |POS70|
|6|XBAN|PROVVMINVIS|AVERE|7130102054|MARK UP_NETTO| | |POS70|
|1|XBAN|PROVVNOUSFR|DARE|8110302001|CANONE_DA RIMBORSARE|ID_PRENOTAZIONE| |POS50|
|2|XBAN|PROVVNOUSFR|AVERE|8110301001|CANONE_DA RIMBORSARE|ID_PRENOTAZIONE| |POS50|
|1|XBAN|PROVVUGVIS|DARE|8110302001|IMPORTO PROVVISTA|ID_PRENOTAZIONE| |POS74|
|2|XBAN|PROVVUGVIS|AVERE|8110302004|IMPORTO PROVVISTA|ID_PRENOTAZIONE| |POS74|
|3|XBAN|PROVVUGVIS|DARE|3210102001|MARK UP_NETTO|CF_CONTR| |POS70|
|4|XBAN|PROVVUGVIS|AVERE|7130102054|MARK UP_NETTO| | |POS70|
|1|XFAR|ADDEBRIMBVISITA|DARE|8110302001|CANONE_DA RIMBORSARE|ID_PRENOTAZIONE| |POS50|
|2|XFAR|ADDEBRIMBVISITA|AVERE|8110301001|CANONE_DA RIMBORSARE|ID_PRENOTAZIONE| |POS50|
|1|XFAR|AUTOMARKUP|DARE|3210102001|MARK UP_NETTO|CF_CONTR| |POS70|
|2|XFAR|AUTOMARKUP|AVERE|3210102102|MARK UP_NETTO|ID_PRENOTAZIONE| |POS70|
|1|XFAR|INCASSOVISITAKO|DARE|8110302001|IMPORTO VISITE  ADDEBITAT|ID_PRENOTAZIONE| |POS73|
|2|XFAR|INCASSOVISITAKO|AVERE|8110302003|IMPORTO VISITE  ADDEBITAT|ID_PRENOTAZIONE| |POS73|
|1|XFAR|INCASSOVISITAOK|DARE|8110302002|IMPORTO VISITE  ADDEBITAT| | |POS73|
|2|XFAR|INCASSOVISITAOK|AVERE|8110302003|IMPORTO VISITE  ADDEBITAT|ID_PRENOTAZIONE| |POS73|
|1|XFAR|INCASSOVOUCHER|DARE|3740101106|COSTO ATT_INCASSATO_LORDO| | |POS41|
|2|XFAR|INCASSOVOUCHER|AVERE|3210101000|COSTO ATT_INCASSATO_LORDO|N_FATTURA|X|POS41|
|1|XFAR|MARKUPTOTMESE|DARE|3210102102|MARK UP_NETTO|ID_PRENOTAZIONE| |POS70|
|2|XFAR|MARKUPTOTMESE|AVERE|3210102001|MARK UP_NETTO|CF_CONTR| |POS70|
|1|XFAR|NUOVAVISITA|DARE|8110302003|IMPORTO VISITE  ADDEBITAT|ID_PRENOTAZIONE| |POS73|
|2|XFAR|NUOVAVISITA|AVERE|8110302001|IMPORTO VISITE  ADDEBITAT|ID_PRENOTAZIONE| |POS73|
|1|XFAR|NUOVOVOUCHER|DARE|3210102100|COSTOATT_NETTO|CF_FARM| |POS30|
|2|XFAR|NUOVOVOUCHER|AVERE|7130102056|COSTOATT_NETTO| | |POS30|
|3|XFAR|NUOVOVOUCHER|DARE|6161711063|IMPORTO RETROCESSIONI_NET| | |POS75|
|4|XFAR|NUOVOVOUCHER|AVERE|5150102011|IMPORTO RETROCESSIONI_NET|CF_PTR| |POS75|
|1|XFAR|PAGPROVVISTA|DARE|8110302004|IMPORTO PROVVISTA|ID_PRENOTAZIONE| |POS74|
|2|XFAR|PAGPROVVISTA|AVERE|8110302002|IMPORTO PROVVISTA| | |POS74|
|1|XFAR|PAGRIMBVISITA|DARE|8110301001|CANONE_RIMBORSATO|ID_PRENOTAZIONE| |POS51|
|2|XFAR|PAGRIMBVISITA|AVERE|8110302002|CANONE_RIMBORSATO| | |POS51|
|1|XFAR|PROVVMINVIS|DARE|8110302001|IMPORTO PROVVISTA|ID_PRENOTAZIONE| |POS74|
|2|XFAR|PROVVMINVIS|AVERE|8110302004|IMPORTO PROVVISTA|ID_PRENOTAZIONE| |POS74|
|5|XFAR|PROVVMINVIS|DARE|3210102001|MARK UP_NETTO|CF_CONTR| |POS70|
|6|XFAR|PROVVMINVIS|AVERE|7130102054|MARK UP_NETTO| | |POS70|
|1|XFAR|PROVVNOUSFR|DARE|8110302001|CANONE_DA RIMBORSARE|ID_PRENOTAZIONE| |POS50|
|2|XFAR|PROVVNOUSFR|AVERE|8110301001|CANONE_DA RIMBORSARE|ID_PRENOTAZIONE| |POS50|
|1|XFAR|PROVVUGVIS|DARE|8110302001|IMPORTO PROVVISTA|ID_PRENOTAZIONE| |POS74|
|2|XFAR|PROVVUGVIS|AVERE|8110302004|IMPORTO PROVVISTA|ID_PRENOTAZIONE| |POS74|
|3|XFAR|PROVVUGVIS|DARE|3210102001|MARK UP_NETTO|CF_CONTR| |POS70|
|4|XFAR|PROVVUGVIS|AVERE|7130102054|MARK UP_NETTO| | |POS70|
|1|XFAR|RIMBVOUCHNOFATT|DARE|7130102056|COSTOATT_NETTO| | |POS30|
|2|XFAR|RIMBVOUCHNOFATT|AVERE|3210102100|COSTOATT_NETTO|CF_FARM| |POS30|
|3|XFAR|RIMBVOUCHNOFATT|DARE|5150102011|IMPORTO RETROCESSIONI_NET|CF_PTR| |POS75|
|4|XFAR|RIMBVOUCHNOFATT|AVERE|6161711063|IMPORTO RETROCESSIONI_NET| | |POS75|
|1|XFAR|RIMBVOUCHSIFATT|DARE|3210101000|COSTO ATT_RIMBORSATO|N_FATTURA|X|POS43|
|2|XFAR|RIMBVOUCHSIFATT|AVERE|3740101106|COSTO ATT_RIMBORSATO| | |POS43|
|3|XFAR|RIMBVOUCHSIFATT|DARE|7130102056|COSTO ATT_INCASSATO_NETTO| | |POS39|
|4|XFAR|RIMBVOUCHSIFATT|AVERE|3210102100|COSTO ATT_INCASSATO_NETTO|CF_FARM| |POS39|
|5|XFAR|RIMBVOUCHSIFATT|DARE|5150102011|IMPORTO RETROCESSIONI_NET|CF_PTR| |POS75|
|6|XFAR|RIMBVOUCHSIFATT|AVERE|6161711063|IMPORTO RETROCESSIONI_NET| | |POS75|
|1|XSEL|ADDEBRIMBVISITA|DARE|8110302001|CANONE_DA RIMBORSARE|ID_PRENOTAZIONE| |POS50|
|2|XSEL|ADDEBRIMBVISITA|AVERE|8110301001|CANONE_DA RIMBORSARE|ID_PRENOTAZIONE| |POS50|
|1|XSEL|AUTOMARKUP|DARE|3210102001|MARK UP_NETTO|CF_CONTR| |POS70|
|2|XSEL|AUTOMARKUP|AVERE|3210102102|MARK UP_NETTO|ID_PRENOTAZIONE| |POS70|
|1|XSEL|INCASSOATTIVAZIONEOK|DARE|3210102101|COSTO ATT_INCASSATO_NETTO|CF_CONTR| |POS39|
|2|XSEL|INCASSOATTIVAZIONEOK|AVERE|7130102057|COSTO ATT_INCASSATO_NETTO| | |POS39|
|3|XSEL|INCASSOATTIVAZIONEOK|DARE|3740101106|COSTO ATT_INCASSATO_LORDO| | |POS41|
|4|XSEL|INCASSOATTIVAZIONEOK|AVERE|3210101000|COSTO ATT_INCASSATO_LORDO|CF_CONTR|X|POS41|
|1|XSEL|INCASSOVISITAKO|DARE|8110302001|IMPORTO VISITE  ADDEBITAT|ID_PRENOTAZIONE| |POS73|
|2|XSEL|INCASSOVISITAKO|AVERE|8110302003|IMPORTO VISITE  ADDEBITAT|ID_PRENOTAZIONE| |POS73|
|1|XSEL|INCASSOVISITAOK|DARE|8110302005|IMPORTO VISITE  ADDEBITAT| | |POS73|
|2|XSEL|INCASSOVISITAOK|AVERE|8110302003|IMPORTO VISITE  ADDEBITAT|ID_PRENOTAZIONE| |POS73|
|1|XSEL|MARKUPTOTMESE|DARE|3210102102|MARK UP_NETTO|ID_PRENOTAZIONE| |POS70|
|2|XSEL|MARKUPTOTMESE|AVERE|3210102001|MARK UP_NETTO|CF_CONTR| |POS70|
|1|XSEL|NUOVAVISITA|DARE|8110302003|IMPORTO VISITE  ADDEBITAT|ID_PRENOTAZIONE| |POS73|
|2|XSEL|NUOVAVISITA|AVERE|8110302001|IMPORTO VISITE  ADDEBITAT|ID_PRENOTAZIONE| |POS73|
|1|XSEL|NUOVOVOUCHER|DARE|3210102100|costoatt_netto|CF_FARM| |POS30|
|2|XSEL|NUOVOVOUCHER|AVERE|7130102056|costoatt_netto| | |POS30|
|3|XSEL|NUOVOVOUCHER|DARE|6161711063|importo retrocessioni_net| | |POS75|
|4|XSEL|NUOVOVOUCHER|AVERE|5150102011|importo retrocessioni_net|CF_PTR| |POS75|
|1|XSEL|PAGPROVVISTA|DARE|8110302004|IMPORTO PROVVISTA|ID_PRENOTAZIONE| |POS74|
|2|XSEL|PAGPROVVISTA|AVERE|8110302002|IMPORTO PROVVISTA| | |POS74|
|1|XSEL|PAGRIMBVISITA|DARE|8110301001|CANONE_RIMBORSATO|ID_PRENOTAZIONE| |POS51|
|2|XSEL|PAGRIMBVISITA|AVERE|8110302002|CANONE_RIMBORSATO| | |POS51|
|1|XSEL|PROVVMINVIS|DARE|8110302001|IMPORTO PROVVISTA|ID_PRENOTAZIONE| |POS74|
|2|XSEL|PROVVMINVIS|AVERE|8110302004|IMPORTO PROVVISTA|ID_PRENOTAZIONE| |POS74|
|5|XSEL|PROVVMINVIS|DARE|3210102001|MARK UP_NETTO|CF_CONTR| |POS70|
|6|XSEL|PROVVMINVIS|AVERE|7130102054|MARK UP_NETTO| | |POS70|
|1|XSEL|PROVVNOUSFR|DARE|8110302001|CANONE_DA RIMBORSARE|ID_PRENOTAZIONE| |POS50|
|2|XSEL|PROVVNOUSFR|AVERE|8110301001|CANONE_DA RIMBORSARE|ID_PRENOTAZIONE| |POS50|
|1|XSEL|PROVVUGVIS|DARE|8110302001|IMPORTO PROVVISTA|ID_PRENOTAZIONE| |POS74|
|2|XSEL|PROVVUGVIS|AVERE|8110302004|IMPORTO PROVVISTA|ID_PRENOTAZIONE| |POS74|
|3|XSEL|PROVVUGVIS|DARE|3210102001|MARK UP_NETTO|CF_CONTR| |POS70|
|4|XSEL|PROVVUGVIS|AVERE|7130102054|MARK UP_NETTO| | |POS70|
|1|XSEL|RIMBORSOATTIVAZIONE|DARE|3210101000|COSTO ATT_INCASSATO_LORDO|CF_CONTR|X|POS41|
|2|XSEL|RIMBORSOATTIVAZIONE|AVERE|3740101106|COSTO ATT_INCASSATO_LORDO| | |POS41|
|3|XSEL|RIMBORSOATTIVAZIONE|DARE|7130102057|COSTO ATT_INCASSATO_NETTO| | |POS39|
|4|XSEL|RIMBORSOATTIVAZIONE|AVERE|3210102101|COSTO ATT_INCASSATO_NETTO|CF_CONTR| |POS39|

## Formato Output 

#### Il formato di output è un documento XLSx da far giarare su excel che sia formattato in questa maniera:

#### F.IN --> File .txt in ingresso(formato della prima tabella)
#### F.IN Excel --> File .XLSx in ingresso(contenuto e formattazione nella seconda tabella)
#### Per ogni Prodotto/TipoOperazione del flusso di ingresso .txt vanno create N righe di Output in base a quante righe del flusso di ingresso Excel ci sono con gli stessi parametri nelle colonne 2 e 3

| Posizione | Prodotto  | TipoOperazione | Contratto | Voucher | Seriale dispositivo |
| :---  |  :---  | :---   | :---   | :---   | :---   | 
| Numero di riga (da 1)  |  F.IN campo 1 | F.IN campo  2  | F.IN campo 3   | F.IN campo 4  | F.IN campo 5  |

|IMEI Dispositivo | cf_contr | data_contabile | D/A| Cont.gen.| Testo testata documento |
| :---  |  :---  | :---   | :---   | :---   | :---   | 
| F.IN campo 6  |  F.IN campo 7 | F.IN campo  26  | F.IN Excel campo "D/A"   | F.IN Excel campo "Cont. Gen." | F.IN Excel campo "Test testata documento"  |

|Importo | Attribuzione | ID PRENOTAZIONE | Numero fattura | id_moviment _incassato |Annualità |
| :---  |  :---  | :---   | :---   | :---   | :---   | 
| F.IN campo (F.IN excel campo "Posizione Campo") |  F.IN Excel campo "Attribuzione"   | F.IN campo  67   | F.IN campo  65  | F.IN campo  64   | F.IN campo  25   |

| ID_ANAG_CONTRAENTE | p iva farmacista | Piva Partner | id_sezionale | Data operazione |
| :---  |  :---  | :---   | :---   | :---   |
| F.IN campo  66  |  F.IN campo  78  | F.IN campo  80   | F.IN campo  79   | F.IN campo  68   |


